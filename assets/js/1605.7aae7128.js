"use strict";(self.webpackChunkdocs_fintesk_com=self.webpackChunkdocs_fintesk_com||[]).push([[1605],{91605:(t,e,s)=>{s.r(e),s.d(e,{orama_search_box:()=>c});var a=s(90872),r=(s(7508),s(9897)),i=s(32980),h=s(1309),o=s(88431),n=class{static{(0,o.a)(this,"SearchService")}constructor(t,e){this.search=async(t,e,s)=>{var r;if(!this.oramaClient)throw new a.b;if(this.abortSearch(),!t)return this.searchStore.state.results=[],this.searchStore.state.count=0,this.searchStore.state.facets=[],void(this.searchStore.state.highlightedIndex=-1);this.searchStore.state.loading=!0;let i=this.abortController,h=null!==(r=this.searchStore.state.searchParams)&&void 0!==r?r:{},{limit:o,offset:n,where:l}=h,c=function(t,e){var s={};for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&e.indexOf(a)<0&&(s[a]=t[a]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(a=Object.getOwnPropertySymbols(t);r<a.length;r++)e.indexOf(a[r])<0&&Object.prototype.propertyIsEnumerable.call(t,a[r])&&(s[a[r]]=t[a[r]])}return s}(h,["limit","offset","where"]),d=Object.assign(Object.assign(Object.assign(Object.assign({},c),{term:t,limit:o||10}),l?{where:l}:{}),this.searchStore.state.facetProperty&&Object.assign({facets:{[this.searchStore.state.facetProperty]:{}}},e&&"All"!==e&&{where:Object.assign({[this.searchStore.state.facetProperty]:{eq:e}},l)}));await this.oramaClient.search(d,{abortController:this.abortController}).then((t=>{var e;if(!i.signal.aborted){if(t&&!t.hits)throw new Error("This search was made by a OramaClient with property mergeResult set to false. Orama Search Service requires mergeResult to be true.");this.searchStore.state.results=this.parserResults(t?.hits,this.searchStore.state.resultMap),this.searchStore.state.count=t?.count||0,this.searchStore.state.facets=this.parseFacets(t?.facets,this.searchStore.state.facetProperty),this.searchStore.state.highlightedIndex=-1,this.searchStore.state.loading=!1,null===(e=s?.onSearchCompletedCallback)||void 0===e||e.call(s,{clientSearchParams:d,result:{results:this.searchStore.state.results,resultsCount:this.searchStore.state.count,facets:this.searchStore.state.facets}})}})).catch((t=>{var e;this.searchStore.state.loading=!1,null===(e=s?.onSearchErrorCallback)||void 0===e||e.call(s,t)}))},this.retry=()=>{throw new Error("Not implemented")},this.parserResults=(t,e)=>{if(!t)return[];let s=[],a={};for(let r of t){let t=this.hitToSearchResultParser(r,e),i="function"==typeof e.section?e.section(r.document):r.document[e.section];if(void 0===a[i])s.push({section:i,items:[t]}),a[i]=s.length-1;else{s[a[i]].items.push(t)}}return s},this.hitToSearchResultParser=(t,e)=>{function s(s){let a=e[s];if(!a)return t.document[s];if("function"==typeof a)return a(t.document);let r=e[s];return t.document[r]}function a(){let s=e.icon;if(!s)return null;if("function"==typeof s){return s(t.document)??null}return e.icon}return(0,o.a)(s,"getResultMapValue"),(0,o.a)(a,"getIcon"),{id:t.id,title:s("title"),description:s("description"),path:s("path"),icon:a()}},this.parseFacets=(t,e)=>{var s;if(!e||!t||null===(s=t[e])||void 0===s||!s.values)return[];let a=t[e],r=Object.values(a.values).reduce(((t,e)=>t+e),0),i=Object.keys(a.values).map((t=>({name:t,count:a.values[t]})));return i.unshift({name:"All",count:r}),i},this.oramaClient=new a.a(t),this.abortController=new AbortController,this.searchStore=e}abortSearch(){this.abortController.abort(),this.abortController=new AbortController}},l=new class extends EventTarget{static{(0,o.a)(this,"WindowService")}constructor(){super(),this._width=window.innerWidth,this.handleResize=this.handleResize.bind(this),window.addEventListener("resize",this.handleResize)}handleResize(){this._width=window.innerWidth,this.dispatchEvent(new CustomEvent("widthChange",{detail:this._width}))}get width(){return this._width}},c=class{static{(0,o.a)(this,"SearchBox")}constructor(t){(0,h.a)(this,t),this.searchCompleted=(0,h.e)(this,"searchCompleted",7),this.searchResultClick=(0,h.e)(this,"searchResultClick",7),this.clearChat=(0,h.e)(this,"clearChat",7),this.startConversation=(0,h.e)(this,"startConversation",7),this.answerGenerated=(0,h.e)(this,"answerGenerated",7),this.answerSourceClick=(0,h.e)(this,"answerSourceClick",7),this.chatMarkdownLinkClicked=(0,h.e)(this,"chatMarkdownLinkClicked",7),this.modalClosed=(0,h.e)(this,"modalClosed",7),this.colorScheme="light",this.open=!1,this.resultMap={},this.disableChat=!1,this.layout="modal",this.highlightTitle=!1,this.highlightDescription=!1,this.componentID=(0,i.f)("search-box"),this.systemScheme="light",this.closeSearchbox=()=>{this.globalStore.state.open=!1,this.open=!1},this.onChatButtonClick=()=>{this.globalStore.state.currentTask="chat"},this.onPrefersColorSchemeChange=t=>{this.systemScheme=t.matches?"dark":"light",this.updateTheme()},this.updateWindowWidth=t=>{this.windowWidth=t.detail}}indexChanged(){this.searchStore&&this.startServices()}watchHandler(){this.updateTheme()}handleOpenPropChange(t){this.globalStore.state.open=t}handleFacetPropertyChange(t){this.searchStore.state.facetProperty=t}handleSearchParamsChange(t){this.searchStore.state.searchParams=t}modalStatusChangedHandler(t){t.detail.id===this.wrapperRef&&(t.detail.open||(this.globalStore.state.open=!1,this.open=!1,this.modalClosed.emit()))}handleKeyDown(t){var e;"search"===(null===(e=this.globalStore)||void 0===e?void 0:e.state.currentTask)&&("modal"===this.layout&&this.open||"embed"===this.layout)&&["ArrowDown","ArrowUp"].includes(t.key)&&(0,i.a)(this.wrapperRef,t)}updateTheme(){let t=(0,i.g)(this.htmlElement,this.colorScheme,this.systemScheme);(0,i.h)(this.htmlElement,t,this.themeConfig)}startServices(){(0,i.d)(this.htmlElement,this.index,this.clientInstance);let t=this.clientInstance?this.clientInstance:(0,i.e)(this.index);this.searchStore.state.searchService=new n(t,this.searchStore),this.chatStore.state.chatService=new a.c(t,this.chatStore)}componentWillLoad(){this.searchStore.state.facetProperty=this.facetProperty,this.searchStore.state.resultMap=this.resultMap,this.searchStore.state.searchParams=this.searchParams,this.htmlElement.id=this.componentID,this.startServices(),this.globalStore.state.open=this.open,this.globalStore.onChange("open",(()=>{this.globalStore&&(this.open=this.globalStore.state.open,this.globalStore.state.open||(this.globalStore.state.currentTerm="",this.searchStore.state.facets=[],this.searchStore.state.count=0,this.searchStore.state.results=[],this.searchStore.state.highlightedIndex=-1,this.searchStore.state.loading=!1,this.searchStore.state.error=!1,this.chatStore.state.interactions=[]))})),this.schemaQuery=window.matchMedia("(prefers-color-scheme: dark)"),this.systemScheme=this.schemaQuery.matches?"dark":"light",this.updateTheme(),this.schemaQuery.addEventListener("change",this.onPrefersColorSchemeChange),l.addEventListener("widthChange",this.updateWindowWidth)}connectedCallback(){this.chatStore=(0,r.a)("chat",this.componentID),this.searchStore=(0,r.a)("search",this.componentID),this.globalStore=(0,r.a)("global",this.componentID),this.windowWidth=l.width}disconnectedCallback(){var t;(0,r.b)(this.componentID),l.removeEventListener("widthChange",this.updateWindowWidth),null===(t=this.schemaQuery)||void 0===t||t.removeEventListener("change",this.onPrefersColorSchemeChange)}getSearchBox(){return(0,h.b)("div",{class:""+(this.windowWidth>1024||"search"===this.globalStore.state.currentTask?"section-active":"section-inactive")},(0,h.b)("orama-search",{placeholder:(null==this?void 0:this.searchPlaceholder)||"Search...",focusInput:"search"===this.globalStore.state.currentTask,sourceBaseUrl:this.sourceBaseUrl,linksTarget:this.linksTarget,linksRel:this.linksRel,highlightTitle:this.highlightTitle,highlightDescription:this.highlightDescription,disableChat:this.disableChat,suggestions:this.suggestions},this.windowWidth>1024&&!this.disableChat&&(0,h.b)("orama-chat-button",{slot:"summary","focus-on-arrow-nav":!0,active:!!this.globalStore.state.currentTerm,label:(this.globalStore.state.currentTerm?`${this.globalStore.state.currentTerm} - `:"")+"Get a summary",onClick:this.onChatButtonClick,onKeyPress:this.onChatButtonClick})))}getChatBox(){return(0,h.b)(h.i,null,(0,h.b)("orama-chat",{class:""+("chat"===this.globalStore.state.currentTask?"section-active":"section-inactive"),defaultTerm:"chat"===this.globalStore.state.currentTask?this.globalStore.state.currentTerm:"",showClearChat:!1,focusInput:"chat"===this.globalStore.state.currentTask,placeholder:(null==this?void 0:this.chatPlaceholder)||this.placeholder,sourceBaseUrl:this.sourceBaseUrl,linksTarget:this.linksTarget,linksRel:this.linksRel,sourcesMap:this.sourcesMap,suggestions:this.suggestions,chatMarkdownLinkTitle:this.chatMarkdownLinkTitle,chatMarkdownLinkHref:this.chatMarkdownLinkHref}))}getInnerContent(){return(0,h.b)(h.i,null,this.disableChat?null:(0,h.b)("orama-navigation-bar",{handleClose:this.closeSearchbox,showBackButton:"embed"!==this.layout,showChatActions:"chat"===this.globalStore.state.currentTask}),(0,h.b)("div",{class:"main"},this.getSearchBox(),this.windowWidth<=1024&&this.getChatBox()),(0,h.b)("orama-footer",{colorScheme:"system"===this.colorScheme?this.systemScheme:this.colorScheme}))}getOuterContent(){return this.windowWidth>1024?(0,h.b)("orama-sliding-panel",{open:"chat"===this.globalStore.state.currentTask,backdrop:"embed"===this.layout,closed:(0,o.a)((()=>{this.globalStore.state.currentTask="search"}),"closed")},this.getChatBox()):null}getModalLayout(){return(0,h.b)(h.i,null,(0,h.b)("orama-modal",{ref:(0,o.a)((t=>this.wrapperRef=t),"ref"),open:this.globalStore.state.open,class:"modal",mainTitle:"Start your search",closeOnEscape:"search"===this.globalStore.state.currentTask||this.windowWidth<=1024},this.getInnerContent()),this.getOuterContent())}getEmbedLayout(){return(0,h.b)(h.i,null,(0,h.b)("orama-embed",{ref:(0,o.a)((t=>this.wrapperRef=t),"ref")},this.getInnerContent()),this.getOuterContent())}render(){return"modal"!==this.layout||this.globalStore.state.open?this.searchStore.state.searchService?this.chatStore.state.chatService?"modal"===this.layout?this.getModalLayout():this.getEmbedLayout():(0,h.b)("orama-text",{as:"p"},"Unable to initialize chat service"):(0,h.b)("orama-text",{as:"p"},"Unable to initialize search service"):null}get htmlElement(){return(0,h.d)(this)}static get watchers(){return{index:["indexChanged"],clientInstance:["indexChanged"],themeConfig:["watchHandler"],colorScheme:["watchHandler"],open:["handleOpenPropChange"],facetProperty:["handleFacetPropertyChange"],searchParams:["handleSearchParamsChange"]}}};c.style="@keyframes showIn{0%{opacity:0;transform:translateY(-25%)}to{opacity:1;transform:translateY(0)}}@media (min-width:1024.02px){.modal orama-input{border-radius:0;margin:0;padding:0}.modal input[type=search]{border-radius:.75rem .75rem 0 0;border-radius:var(--radius-m,calc(12rem/var(--orama-base-font-size, 16))) var(--radius-m,calc(12rem/var(--orama-base-font-size, 16))) 0 0}}.main{flex-direction:column;flex-grow:1}.main,.section-active{display:flex;overflow:hidden}.section-inactive{display:none}"}}]);